<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Shadowed Tomb</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

<style>
:root{
  --accent:#e50914;
}

html,body{
  margin:0;
  padding:0;
  background:#000;
  height:100%;
  overflow:auto;
  font-family:'Montserrat',sans-serif;
  color:white;
}

/* ================= NAVBAR ================= */

.navbar{
  position:fixed;
  top:0;
  left:0;
  right:0;
  height:70px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 50px;
  background:linear-gradient(to bottom, rgba(0,0,0,0.85), transparent);
  transition:background 0.4s ease;
  z-index:20;
}

.navbar.scrolled{
  background:rgba(0,0,0,0.95);
}

.nav-left{
  font-family:'Orbitron',sans-serif;
  font-size:22px;
  letter-spacing:3px;
  color:var(--accent);
  cursor:pointer;
  position:relative;
}

/* Netflix underline hover animation */
.nav-left::after{
  content:"";
  position:absolute;
  left:0;
  bottom:-6px;
  width:0%;
  height:2px;
  background:var(--accent);
  transition:width 0.3s ease;
}

.nav-left:hover::after{
  width:100%;
}

/* ================= INTRO ================= */

#intro{
  position:fixed;
  inset:0;
  background:#000;
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:100;
  animation:introFade 3s forwards;
}

#intro h1{
  font-family:'Orbitron',sans-serif;
  font-size:60px;
  letter-spacing:10px;
  margin:0;
  opacity:0;
  animation:titleFade 1.5s forwards;
}

#intro .line{
  width:0;
  height:3px;
  background:var(--accent);
  margin-top:20px;
  animation:lineExpand 1.5s forwards;
}

@keyframes titleFade{to{opacity:1;}}
@keyframes lineExpand{to{width:280px;}}
@keyframes introFade{
  0%{opacity:1;}
  85%{opacity:1;}
  100%{opacity:0; visibility:hidden;}
}

/* ================= BACKGROUND ================= */

#bg{
  position:fixed;
  inset:0;
  z-index:0;
}

/* ================= PLAYER ================= */

#player{
  position:absolute;
  width:90vw;
  max-width:1100px;

  background:rgba(20,20,20,0.55);
  backdrop-filter:blur(20px) saturate(120%);
  border-radius:20px;
  overflow:hidden;

  box-shadow:0 80px 200px rgba(0,0,0,0.95);

  z-index:10;
  border:1px solid rgba(255,255,255,0.08);
  transition:all 0.4s ease;
}

/* MINI MODE */
#player.mini{
  width:320px;
  height:180px;
  bottom:20px;
  right:20px;
  top:auto !important;
  left:auto !important;
  border-radius:12px;
}

/* Header */
.header{
  height:65px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 30px;
  background:linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
  cursor:grab;
}

.header span{
  font-family:'Orbitron',sans-serif;
  font-size:15px;
  letter-spacing:2px;
}

/* Video */
.viewport{
  aspect-ratio:16/9;
  background:#000;
}

video{
  width:100%;
  height:100%;
  object-fit:contain;
}

/* Controls */
.controls{
  padding:18px 30px;
  background:rgba(0,0,0,0.6);
  display:flex;
  gap:16px;
  align-items:center;
  transition:opacity 0.3s ease;
}

.controls.hidden{
  opacity:0;
  pointer-events:none;
}

button{
  background:rgba(255,255,255,0.08);
  color:white;
  border:none;
  padding:10px 18px;
  border-radius:8px;
  cursor:pointer;
  font-size:13px;
  transition:0.2s ease;
}

button:hover{
  background:var(--accent);
  box-shadow:0 0 14px rgba(229,9,20,0.6);
}

.progress-container{
  height:6px;
  background:rgba(255,255,255,0.15);
  cursor:pointer;
}

.progress{
  height:100%;
  width:0%;
  background:var(--accent);
}
</style>
</head>
<body>

<div class="navbar" id="navbar">
  <div class="nav-left">SHADOWED TOMB</div>
</div>

<div id="intro">
  <h1>SHADOWED TOMB</h1>
  <div class="line"></div>
</div>

<canvas id="bg"></canvas>

<div id="player">
  <div class="header" id="dragHandle">
    <span>STREAM</span>
    <div>
      <button onclick="toggleMini()">Mini</button>
      <button onclick="goFullscreen()">Fullscreen</button>
    </div>
  </div>

  <div class="viewport" id="tapArea">
    <video id="video" controls playsinline></video>
  </div>

  <div class="controls" id="controls">
    <button onclick="toggle()">Play / Pause</button>
  </div>

  <div class="progress-container" id="progressContainer">
    <div class="progress" id="progressBar"></div>
  </div>
</div>

<script>

/* NAV SCROLL FADE */
window.addEventListener("scroll",()=>{
  const nav=document.getElementById("navbar");
  if(window.scrollY>20){
    nav.classList.add("scrolled");
  }else{
    nav.classList.remove("scrolled");
  }
});

/* MINI MODE */
function toggleMini(){
  const player=document.getElementById("player");
  player.classList.toggle("mini");
}

/* STREAM */
const video=document.getElementById("video");
const params=new URLSearchParams(window.location.search);
const streamUrl=params.get("video");
if(streamUrl) video.src=streamUrl;

/* PROGRESS */
const progressBar=document.getElementById("progressBar");
video.addEventListener("timeupdate",()=>{
  if(video.duration){
    progressBar.style.width=(video.currentTime/video.duration*100)+"%";
  }
});

/* DRAG FIX */
const player=document.getElementById("player");
const handle=document.getElementById("dragHandle");

let isDragging=false;
let offsetX=0, offsetY=0;

handle.addEventListener("pointerdown",e=>{
  if(player.classList.contains("mini")) return;
  isDragging=true;
  const rect=player.getBoundingClientRect();
  offsetX=e.clientX - rect.left;
  offsetY=e.clientY - rect.top;
  handle.setPointerCapture(e.pointerId);
});

handle.addEventListener("pointermove",e=>{
  if(!isDragging) return;

  let newLeft=e.clientX - offsetX;
  let newTop=e.clientY - offsetY;

  newLeft=Math.max(0,Math.min(window.innerWidth-player.offsetWidth,newLeft));
  newTop=Math.max(70,Math.min(window.innerHeight-player.offsetHeight,newTop));

  player.style.left=newLeft+"px";
  player.style.top=newTop+"px";
});

handle.addEventListener("pointerup",()=>isDragging=false);

/* BACKGROUND */
const canvas=document.getElementById("bg");
const ctx=canvas.getContext("2d");
let W,H;

function resize(){
  W=canvas.width=window.innerWidth;
  H=canvas.height=window.innerHeight;
}
resize();
window.addEventListener("resize",resize);

let stars=[];
for(let i=0;i<250;i++){
  stars.push({
    x:Math.random()*W,
    y:Math.random()*H,
    z:Math.random()*1.5+0.5
  });
}

function renderBG(){
  requestAnimationFrame(renderBG);

  ctx.fillStyle="rgba(0,0,0,0.12)";
  ctx.fillRect(0,0,W,H);

  stars.forEach(s=>{
    ctx.fillStyle="rgba(255,255,255,"+(0.3*s.z)+")";
    ctx.fillRect(s.x,s.y,2*s.z,2*s.z);
    s.y+=0.08*s.z;
    if(s.y>H){
      s.y=0;
      s.x=Math.random()*W;
    }
  });

  ctx.strokeStyle="rgba(229,9,20,0.25)";
  ctx.beginPath();
  for(let x=0;x<W;x++){
    let y=H*0.75+Math.sin(x*0.01+Date.now()*0.0007)*25;
    ctx.lineTo(x,y);
  }
  ctx.stroke();
}
renderBG();

function toggle(){
  video.paused?video.play():video.pause();
}

function goFullscreen(){
  video.requestFullscreen();
}

</script>
</body>
</html>
